<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Hazanot</title>
  <style>
  #button {
    display: block;
    margin-top: 10px;
    width: 50px;
    height: 40px;
    cursor: pointer;
  }
  select {
    display: inline-block;
  }
/*  .time {
    display: inline-block;
  }*/
  </style>
</head>
<body>
  <h1>הזנות ל842</h1>
  <form id='form' action="">
  <h2>כמה אנשים מזינים</h2>
  <input id='people', type="number" required>
  <h3>מאיזו שעה</h3>
  <input id='start' type="time" required>
  <h3>עד איזה שעה</h3>
  <input id='end' type="time" required>
  <input id='button' value="GO" type="submit">
  </form>
  <div id="result"></div>

<script>
  const soldiers = ['zwil','debi', 'shuki', 'ismael', 'bardugo', 'goldi', 'vaanununu', 'karni', 'gidon', 'other']
        const result = document.getElementById("result")
  let dropdownHTML=''
  soldiers.forEach(function(item, index){  dropdownHTML +=(`<option>${item}</option>`)});
  console.log(dropdownHTML)
    document.getElementById('form').addEventListener('submit', function(e){
          e.preventDefault();
      result.innerHTML = ''

      const people = parseInt(document.getElementById("people").value);
      const start = document.getElementById("start").value;

      const end = document.getElementById("end").value;

      var timeStart = new Date("01/01/2007 " + start)
      var timeEnd = new Date("01/01/2007 " + end);
      if(timeEnd<timeStart){
        timeEnd = new Date("01/02/2007 " + end);
        console.log(timeEnd);
      }
      var hourDiff = timeEnd - timeStart;

       var diff =(timeEnd.getTime() - timeStart.getTime()) / 1000;
  diff /= 60;
  const totalTime = Math.abs(Math.round(diff));
  const timePP = totalTime/people
  const times = []

  var coeff = 1000 * 60 * 5;



  times[0] = timeStart
  for (var i = 1; i < people +1 ; i++) {
    times[i]=  new Date(times[i-1].getTime() + timePP*60000);
  }
  var niceTimes = []
times.forEach(function(item, index){
  item = new Date(Math.round(item / coeff) * coeff)
 niceTimes[index] = item.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
})
niceTimes.forEach(function(item, index, arr){
  // item = Math.Round(item)
   if (Object.is(arr.length - 1, index)) {return}
  result.innerHTML = result.innerHTML + `<div class='time'> <span>${item} - ${niceTimes[index+1]}</span  </div> <select>${dropdownHTML}</select>`
})




    })
  </script>
</body>
</html>
